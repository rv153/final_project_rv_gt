library(dplyr)
library(ggplot2)
library(shiny)
library(plotly)


df <- read.csv("UnifiedDataset.csv")

# Define the first page content
page_one <- tabPanel(
  "About", 
  titlePanel("About"), 
  
  h3("Understanding Drug Abuse Among College Students"),
  
  p("Drug abuse among college students is a pressing concern, given the numerous factors that contribute to its prevalence. 
    Academic pressure, social influences, and newfound independence often intersect, leading some students to engage in substance abuse."),
  
  br(),
  
  p("Research by University of Michigan indicates a rising trend in drug abuse, but studies tracking substance use from college into later adulthood are scarce. 
    The Monitoring the Future (MTF) program provides valuable insights by analyzing substance use across different life stages, 
    revealing long-term effects and connections between substance use and various outcomes like substance use disorders, health issues, 
    and social functioning."),
  
  br(),
  
  p("Throughout these pages, we will explore the causes, effects, and implications of this increasing trend in drug abuse among college students.")
)

# Define content for the second page
page_two <- tabPanel(
  "by Age & Gender", 
  titlePanel("by Age & Gender"), 
  sidebarLayout(
    sidebarPanel(plotlyOutput(outputId = "barplot")),
    mainPanel(
plotlyOutput(outputId = "female_plot"),  # First plot
      plotlyOutput(outputId = "male_plot")  # Second plot
      h3("Drug Abuse by Age & Gender"),
      p("Certain age groups and genders exhibit varying susceptibilities to drug abuse, highlighting the importance of understanding these disparities."),
      
      br(),
      
      p("The data reveals intriguing patterns in female participation across various age groups and drug types.
        Among females aged 17-19, marijuana shows the highest involvement at 52.20%, while opioids demonstrate a
        substantial participation of 30%. In the 18-20 age bracket, engagement in study drugs is notably lower, standing
        at 11.20%. As the age range extends to 18-22, alcohol exhibits relatively higher participation among females
        at 44.50%. In the 21-25 age group, females also show involvement in cigarette use, with a participation rate of
        23.67%. Across these age brackets, there's a fluctuating trend in female engagement with different substances,
        suggesting varying propensities for substance involvement as individuals progress through different stages of late
        adolescence and early adulthood.."),
      
      br(),
      
      p("These disparities might be influenced by diverse factors, including social pressures, access to substances, 
        and psychological vulnerabilities. Targeted interventions aimed at specific age groups and genders 
        could effectively address these varying trends in drug abuse.")
    )
  )
)


# Define content for the third page
page_three <- tabPanel(
  "Impact on Drug Types", 
  titlePanel("Impact on Drug Types"), 
  sidebarLayout(
    sidebarPanel(plotlyOutput(outputId = "drug_type_plot")),
    mainPanel(
      h3("Shift in Drug Abuse Patterns by Types"),
      p("There has been a notable shift in drug abuse patterns, particularly concerning various drug types among college students."),
      
      br(),
      
      p("The data showcases diverse trends in student participation concerning different drug types.
        Marijuana and alcohol exhibit substantial student engagement, with rates of 10% and 45.6%, respectively.
        Cigarette usage reflects a moderate participation rate at 37.69%. Opioids and study drugs also draw
        attention, with 12.4% and 63.4% participation rates, respectively. This spectrum of participation indicates
        varying levels of involvement across different drug types among students, suggesting distinct preferences and
        degrees of interaction with these substances."),
      
      br(),
      
      p("This shift might be influenced by various factors such as changes in availability, shifting societal norms, 
        and alterations in individual preferences, leading to a noteworthy change in the abuse patterns of certain drug types.")
    )
  )
)

# Define content for the fourth page
page_four <- tabPanel(
  "Solutions", 
  titlePanel("Solutions"), 
  h3("Addressing Drug Abuse Challenges"),
  p("The challenges of drug abuse among college students have intensified during the pandemic."),
  
  br(),
  
  p("Implementing effective solutions such as increased access to counseling services, targeted educational programs, 
    and fostering a supportive campus environment can mitigate the rising trend of drug abuse. Additionally, 
    providing resources and support tailored to vulnerable communities is imperative."),
  
  br(),
  
  p("While there is no one-size-fits-all solution, targeted interventions and increased support systems 
    can make a substantial difference in curbing drug abuse among college students.")
)

# Define content for the fifth page
page_five <- tabPanel(
  "Overview", 
  titlePanel("Overview"), 
  h3("Why Focus on Drug Abuse?"),
  p("The prevalence of drug abuse among college students poses significant challenges, impacting academic performance, 
    mental and physical health, and future prospects."),
  
  br(),
  
  h3("Taking Action"),
  p("As part of the University of Washington, acknowledging and addressing this issue is crucial. By implementing comprehensive 
    strategies and support systems, we can create a healthier and more conducive environment for our student community.")
)

# Pass each page to a multi-page layout using `navbarPage`
ui <- navbarPage(
  "Drug Abuse Among College Students", 
  page_one,         
  page_two,         
  page_three,       
  page_four,       
  page_five        
)

server <- function(input, output, session) {
  output$female_plot <- renderPlot({
    ggplot(df, aes(x = Ages, y = Female)) +
      geom_bar(stat = "identity", fill = "skyblue", width = 0.5) +
      labs(title = "Percentage of Females Involved in Drug Abuse by Age",
           x = "Age Group",
           y = "Percentage of Females") +
      theme_minimal()
  })

  output$male_plot <- renderPlot({
    ggplot(df, aes(x = Ages, y = Male)) +
      geom_bar(stat = "identity", fill = "lightgreen", width = 0.5) +
      labs(title = "Percentage of Males Involved in Drug Abuse by Age",
           x = "Age Group",
           y = "Percentage of Males") +
      theme_minimal()
  })

  output$drug_type_plot <- renderPlot({
    ggplot(df, aes(x = Drug_Type, y = Student_Participation)) +
      geom_bar(stat = "identity", fill = "cornflowerblue", width = 0.5) +
      labs(title = "Student Participation Rates in Different Drug Types",
           x = "Drug Types",
           y = "Student Participation (%)") +
      theme_minimal() +
      theme(axis.text.x = element_text(angle = 45, hjust = 1))
  })
}

shinyApp(ui, server)
